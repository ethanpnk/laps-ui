# LAPS-UI v1.0.2

Client lÃ©ger **PowerShell/WPF** pour consulter les mots de passe **Windows LAPS** & **Legacy LAPS** depuis un poste Windows 10/11 â€” sans module ActiveDirectory.

---

## âœ¨ NouveautÃ©s / Modifs

- âœ… **MÃ©moriser lâ€™utilisateur** : case Ã  cocher + persistance dans `%LOCALAPPDATA%\LAPS-UI\prefs.json` (nom dâ€™utilisateur uniquement).
- âœ… **Champ mot de passe LAPS non-Ã©ditable** (sÃ©curitÃ©/UX).
- âœ… **Message vert â€œPresse-papiers effacÃ©â€** fiable en fin de compte Ã  rebours (fix du timer).
- âœ… **LDAP par dÃ©faut** (LDAPS facultatif via case Ã  cocher).
- âœ… UI **WPF** sombre modernisÃ©e (alignements, espacements, boutons plus confortables).
- âœ… CompatibilitÃ© **Windows LAPS (msLAPS-Password)** + **Legacy LAPS (ms-Mcs-AdmPwd)**.

> â„¹ï¸ Le **.exe nâ€™est pas signÃ©** (pas de code-signing). SmartScreen/EDR peuvent afficher un avertissement.
> - PrÃ©fÃ©rez le **script .ps1** ou **signez** lâ€™exÃ©cutable avant dÃ©ploiement.
> - Pensez Ã  **vÃ©rifier lâ€™empreinte SHA256** du binaire tÃ©lÃ©chargÃ© (cf. plus bas).

---

## ğŸ“¥ TÃ©lÃ©chargement

- **ExÃ©cutable** : voir les **Assets** ci-dessous â†’ `LAPS-UI.exe`  
- **Script** : `LAPS-UI.ps1` est disponible dans le **dÃ©pÃ´t** (racine)

---

## â–¶ï¸ Lancer

**Option A â€“ EXE (simple)**  
Double-cliquez `LAPS-UI.exe`.  
Si SmartScreen/EDR bloque : utilisez le `.ps1`, signez lâ€™EXE ou faites lâ€™approuver (AppLocker/WDAC/EDR).

**Option B â€“ PS1 (recommandÃ© si politiques strictes)**

```powershell
Unblock-File .\LAPS-UI.ps1
powershell.exe -NoProfile -ExecutionPolicy Bypass -sta -File .\LAPS-UI.ps1
```
---

## âœ… PrÃ©requis
- Windows 10/11 â€¢ Windows PowerShell 5.1 â€¢ .NET Framework 4.7+
- AccÃ¨s vers un DC (LDAP 389 / LDAPS 636)
- Droits de lecture LAPS dÃ©lÃ©guÃ©s sur les objets **Computer**

## ğŸ”’ SÃ©curitÃ©
- Aucun mot de passe Ã©crit sur disque.
- Purge auto du presse-papiers aprÃ¨s 20 s (si le contenu nâ€™a pas changÃ©).
- Tentative dâ€™utiliser lâ€™API WinRT (`IsAllowedInHistory=false`) pour Ã©viter lâ€™historique Win+V.
- Selon la config Windows/tenant, cette exclusion peut ne pas Ãªtre honorÃ©e hors package **MSIX**.  
  **Solutions 100 % efficaces** : dÃ©sactiver lâ€™historique via **GPO** ou packager en **MSIX** signÃ©.
- Lâ€™option **MÃ©moriser lâ€™utilisateur** stocke seulement `UserName` / `RememberUser`.

## ğŸ” VÃ©rifier lâ€™intÃ©gritÃ©
Commande PowerShell :
`Get-FileHash .\LAPS-UI.exe -Algorithm SHA256 | Select-Object Hash`

Comparez la valeur obtenue avec celle attendue (ou publiez un `SHA256SUMS.txt` dans la release).

